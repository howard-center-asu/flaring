---
title: "Colorado Flaring and Venting"
author: "Izzy Koyama, Zach Van Arsdale"
output: 
  html_document:
      code_folding: show
      df_print: paged
      toc: true
      toc_float: true
      code_download: true
---

```{r setup, message = FALSE, class.source="fold-hide"}

# For general data science
library(tidyverse)

# For working with datetime
library(lubridate)

# For pretty tables
library(gt)

knitr::opts_chunk$set(echo = TRUE)

```

# Introduction

Oil and gas companies in Colorado are required to file monthly production reports (called a form 7) with the Colorado Oil and Gas Conservation Commission, reporting an estimation or measurement of the volume of gas they flared or vented. More information on the form 7 and what it reports can be found on the Commission's [website](https://cogcc.state.co.us/reg.html#/forms/form7_new). Instructions can be downloaded [here](https://cogcc.state.co.us/documents/reg/Forms/instructions/data_templates/Form7wInstructions.xls), and an example of a filled out form is available [here](https://cogcc.state.co.us/documents/reg/Forms/instructions/Example_Forms/fm7_page1_example.pdf). Reported gas flared or vented is measured in thousand cubic feet (Mcf).

An annual compilation of production reports can be found on the commissions [downloads page](https://cogcc.state.co.us/data2.html#/downloads) under all production reports received by year. This analysis uses annual reports from 2012-2020. (Please note that reports from previous years are sometimes included in each zip.) The data dictionary is available from the commission, [here](https://cogcc.state.co.us/documents/data/downloads/production/production_record_data_dictionary.htm) This data is current as of August 6, 2021.

# Load data

Annual data for Colorado needed to be downloaded year-to-year, compiled, then cleaned. For a copy of this data cleaning, contact Jimmy Cloutier at [jclouti3@asu.edu](mailto:jclouti3@asu.edu). The compiled data was saved as an .csv to the Howard Center drive, [here](https://drive.google.com/file/d/1Kh13rdkcBjCkQHEM3V2NFjeVMkqQ-Qxc/view?usp=sharing). 

We uploaded this file into R. Each row represents a company's monthly report for flaring and venting from a particular well drilling from a particular formation. 

```{r load data}

id <- "1Kh13rdkcBjCkQHEM3V2NFjeVMkqQ-Qxc" # google file ID
co <- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id))

```

# Total flared/vented volumes 

Claim: "Combined flared/vented gas volumes, as reported to the state: 45,228,287,000 cubic feet

We arrived at these totals by aggregating flaring volumes for every year. We first extracted the year from the `reported_date` variable, then grouped by year to calculate annual totals. Using the gt package, we arrive at a total for volume flared from 2012 - 2020. 

```{r calculate annual totals, etcho=TRUE}

co_annualtotals <- co %>%
   mutate(report_date = as.Date(report_date, format = "%Y-%m-%d"), 
          year = year(report_date)) %>%
   filter(year >= 2012 & year <= 2020) %>%
   group_by(year) %>%
   summarise(Total = sum(flared, na.rm = TRUE))

co_annualtotals %>%
   gt(rowname_col = "year") %>%
   tab_stubhead(label = "Year") %>%
   tab_header(title = "Flaring Volumes Reported to COGCC",
              subtitle = "Flaring volumes in Mcf (thousand cubic feet)") %>%
   fmt_number(column = "Total",
              decimals = 0) %>%
   grand_summary_rows(fns = list("Total" = "sum"),
                      columns = "Total",
                      formatter=gt::fmt_number,
                      decimals=0)

```




