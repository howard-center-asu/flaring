---
title: "Utah flaring and venting totals"
author: "Zoha Tunio and Sarah Hunt"
output:
  html_document: default
---

```{r setup, message=FALSE, class.source="fold-hide"}

# For general data science
library(tidyverse)

# For reading Excel files
library(readxl)

# For data cleaning
library(janitor)

# For working with datetime
library(lubridate)

# For pretty tables
library(knitr)
library(gt)

knitr::opts_chunk$set(echo = TRUE)

```

# Introduction

The Utah Division of Oil, Gas and Mining requires oil and gas operators on producing, shut-in and temporarily abandoned wells to fill a form titled `Form 11` (https://oilgas.ogm.utah.gov/pub/report_forms/frm_11_2005.pdf) with information on flared and vented gas. 

Data from the monthly reports (2012-present) are available at the division's website under its Data Research Center tab [here] (https://oilgas.ogm.utah.gov/oilgasweb/data-center/dc-main.xhtml). Click `Disposition Data (2009-2014; can open in Excel),` `Disposition Data (2015-2019; can open in Excel),` and `Disposition Data (2020-2024; can open in Excel)` to download the data sets for our selected time frame. This will download the data in .csv format. 


#Load Data

We compiled and cleaned the data from the state regulatory agency and saved it as a new dataset available from the Howard Center [here](https://drive.google.com/file/d/1R3FPAoFZDiJzdnMJpljVHrmak-TZu4dA/view?usp=sharing). (For more information about our data cleaning, please contact: howardcenter@asu.edu) 

We created a fresh csv file for the analysis: `ut_flaring_and_venting.csv`


```{r load_and_clean_data, echo=TRUE}

id <- "1R3FPAoFZDiJzdnMJpljVHrmak-TZu4dA" # google file ID
ut <- read_csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id))

```


# Analysis

FACT: "According to state data, oil and gas companies in Utah flared and vented 11,390,778,000 cubic feet of natural gas between 2012 and 2020."

We first first for the years covered (2012-2020), then group by year to calculate annual flared and vented volumes. Using the `gt` package, we calculate a grand total. 


```{r}

ut %>%
  filter(year >= 2012 & year <= 2020) %>%
  group_by(year) %>%
  summarise(total = sum(Vol.VentedFlared, na.rm = TRUE)) %>%
  gt(rowname_col = "year") %>%
  grand_summary_rows(fns = list("total" = "sum")) %>%
  print()


```

